# 2.11 Raw TCP –∏ —Å–µ—Ç–µ–≤—ã–µ —Ç—é–Ω–∏–Ω–≥–∏

## 1. Echo-—Å–µ—Ä–≤–µ—Ä –±–µ–∑ `net/http`
```go
func main() {
    ln, _ := net.Listen("tcp", ":9000")
    for {
        conn, _ := ln.Accept()
        go handle(conn)
    }
}
func handle(c net.Conn) {
    defer c.Close()
    io.Copy(c, c) // —á–∏—Ç–∞–µ—Ç –∏ –ø–∏—à–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ
}
```

## 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```go
addr, _ := net.ResolveTCPAddr("tcp", "example.com:80")
conn, _ := net.DialTCP("tcp", nil, addr)
conn.SetKeepAlive(true)
conn.SetNoDelay(true) // –≤—ã–∫–ª—é—á–∞–µ–º Nagle
```

## 3. Deadline
```go
conn.SetDeadline(time.Now().Add(5 * time.Second))
```
–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–µ—Ä–Ω—É—Ç `i/o timeout`.

## 4. –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sync.Pool` –∏–ª–∏ –≤–Ω–µ—à–Ω—é—é –ª–∏–±—É `github.com/jolestar/go-commons-pool/v2`.

## 5. –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ø–æ–≤–µ—Ä—Ö TCP (SMTP, Redis)
–î–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —É–¥–æ–±–Ω–æ –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞—Ç—å `*bufio.ReadWriter`.

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è üìù
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ TCP-–∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ echo-—Å–µ—Ä–≤–µ—Ä—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É –∏–∑ stdin.  
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–∞–π–º–∞—É—Ç 2 —Å; –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Äî –≤—ã–≤–æ–¥–∏—Ç–µ ¬´timeout¬ª.  
3. –ò–∑–º–µ—Ä—å—Ç–µ RTT: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `time.Now`).
