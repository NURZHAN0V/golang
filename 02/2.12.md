# 2.12 –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥-—Ñ–∞–π–ª–æ–≤

> –ü–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç—É—â–∏–π `app.log` –æ–¥–Ω–∞–∂–¥—ã –∑–∞–ø–æ–ª–Ω–∏—Ç –¥–∏—Å–∫. –†–µ—à–µ–Ω–∏–µ ‚Äî —Ä–æ—Ç–∞—Ü–∏—è: –∫–æ–≥–¥–∞ —Ñ–∞–π–ª –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ø–æ—Ä–æ–≥–∞, —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π, —Å—Ç–∞—Ä—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è –∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è.

## 1. –ü–∞–∫–µ—Ç `lumberjack` (–¥–µ-—Ñ–∞–∫—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç)
```bash
go get github.com/natefinch/lumberjack/v3@latest
```
```go
logger := &lumberjack.Logger{
    Filename:   "app.log",
    MaxSize:    10, // –º–µ–≥–∞–±–∞–π—Ç—ã
    MaxBackups: 5,
    MaxAge:     30, // –¥–Ω–∏
    Compress:   true,
}
log.SetOutput(logger) // std log
```

## 2. –°–æ–≤–º–µ—â–µ–Ω–∏–µ —Å `slog`
```go
h := slog.NewJSONHandler(logger, nil)
app := slog.New(h)
app.Info("rotated")
```

## 3. –†–æ—Ç–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
`lumberjack` –∫—Ä—É—Ç–∏—Ç –ø–æ —Ä–∞–∑–º–µ—Ä—É. –î–ª—è –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `github.com/lestrrat-go/file-rotatelogs`.

```go
rl, _ := rotatelogs.New(
    "app.%Y%m%d.log",
    rotatelogs.WithLinkName("app.log"),
    rotatelogs.WithMaxAge(7*24*time.Hour),
    rotatelogs.WithRotationTime(24*time.Hour),
)
log.SetOutput(rl)
```

## 4. –õ–æ–≥–∏ –≤ journald / syslog
–í Docker –ª—É—á—à–µ –ø–∏—Å–∞—Ç—å –≤ stdout, –∞ —Ä–æ—Ç–∞—Ü–∏—é –¥–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä-–ª–æ–≥–≥–µ—Ä—É. –î–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
```go
w, _ := syslog.New(syslog.LOG_INFO, "myapp")
log.SetOutput(w)
```

## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ü–∏–∫–ª, –ø–∏—à—É—â–∏–π 100 000 —Å—Ç—Ä–æ–∫, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–∑–¥–∞–ª–∏—Å—å `app.log`, `app.log.1.gz`‚Ä¶

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è üìù
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `lumberjack` –Ω–∞ 1 –ú–ë –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞—Ä—Ö–∏–≤.  
2. –ü–æ–¥–Ω–∏–º–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Alpine + –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ; —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–æ—Ç–∞—Ü–∏—é –¥–µ–ª–∞–µ—Ç Docker (`--log-opt max-size=5m`).
