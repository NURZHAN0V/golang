# –ü—Ä–æ–µ–∫—Ç üî¨ CLI-—É—Ç–∏–ª–∏—Ç–∞ (cobra)

## –¶–µ–ª—å
–°–¥–µ–ª–∞–µ–º –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—É—é —É—Ç–∏–ª–∏—Ç—É `todo` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º –∑–∞–¥–∞—á –≤ JSON-—Ñ–∞–π–ª–µ.

## 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
mkdir -p ~/projects/todo-cli && cd $_
go mod init example.com/todo
```

## 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cobra-generator
```bash
go install github.com/spf13/cobra-cli@latest
cobra-cli init --pkg-name example.com/todo
```
–°–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
```
cmd/
  root.go  # –±–∞–∑–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞
main.go
```

## 3. –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–∫–æ–º–∞–Ω–¥—ã
```bash
cobra-cli add add    # todo add "–∫—É–ø–∏—Ç—å —Ö–ª–µ–±"
cobra-cli add list   # todo list
cobra-cli add done   # todo done 2
```
–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª `cmd/*.go` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∞—Ä–∫–∞—Å `Run: func(cmd *cobra.Command, args []string){}`.

### cmd/add.go
```go
var file string
func init(){
  addCmd.Flags().StringVarP(&file, "file", "f", "tasks.json", "path to file")
}
func runAdd(_ *cobra.Command, args []string){
  task := strings.Join(args, " ")
  tasks := load(file)
  tasks = append(tasks, task)
  save(file, tasks)
  fmt.Println("added:", task)
}
```

### –•–µ–ª–ø–µ—Ä—ã load/save
```go
func load(p string) []string {
  data, _ := os.ReadFile(p)
  var t []string
  json.Unmarshal(data, &t)
  return t
}
func save(p string, t []string){
  data, _ := json.MarshalIndent(t, "", "  ")
  os.WriteFile(p, data, 0o644)
}
```

## 4. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø–æ–¥ –≤—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
```bash
go run github.com/mitchellh/gox -os="linux darwin windows" -arch="amd64" -output="dist/{{.OS}}/{{.Arch}}/todo"
```

## 5. –£–ª—É—á—à–µ–Ω–∏—è
* –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ (`github.com/fatih/color`).  
* –§–ª–∞–≥ `--format=csv|json|table`.  
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub-Actions: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–ª–∏–∑ —á–µ—Ä–µ–∑ goreleaser.

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `rm` –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ –∏–Ω–¥–µ–∫—Å—É.  
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–∫–æ–º–∞–Ω–¥—É `import <file.csv>`.
