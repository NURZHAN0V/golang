# Работа с файлами

В Go работа с файлами — это базовая задача для многих приложений: **чтение конфигураций, запись логов, обработка данных**. Go предоставляет для этого пакет **`os`**, а также удобные вспомогательные пакеты **`io` и `io/ioutil`** (в новых версиях `io/ioutil` постепенно заменяется на `os` и `io`).

---

### Открытие и создание файлов

* Чтобы открыть существующий файл:

```go
file, err := os.Open("example.txt")
if err != nil {
    fmt.Println("Ошибка при открытии файла:", err)
    return
}
defer file.Close()
```

* Чтобы создать новый файл или перезаписать существующий:

```go
file, err := os.Create("output.txt")
if err != nil {
    fmt.Println("Ошибка при создании файла:", err)
    return
}
defer file.Close()
```

* **Важно:** всегда использовать `defer file.Close()`, чтобы файл корректно закрывался и ресурсы освобождались.

---

### Чтение из файла

1. **Чтение всего файла целиком** (для небольших файлов):

```go
data, err := os.ReadFile("example.txt")
if err != nil {
    fmt.Println("Ошибка чтения файла:", err)
    return
}
fmt.Println(string(data))
```

2. **Построчное чтение с bufio.Scanner**:

```go
scanner := bufio.NewScanner(file)
for scanner.Scan() {
    fmt.Println(scanner.Text())
}
if err := scanner.Err(); err != nil {
    fmt.Println("Ошибка при сканировании:", err)
}
```

* Scanner удобен для **обработки больших файлов построчно**, не загружая весь файл в память.

---

### Запись в файл

1. **Запись всей строки за один раз**:

```go
data := []byte("Привет, Go!\n")
err := os.WriteFile("output.txt", data, 0644)
if err != nil {
    fmt.Println("Ошибка записи файла:", err)
}
```

* `0644` — это **права доступа к файлу** (чтение/запись).

2. **Построчная запись с bufio.Writer**:

```go
writer := bufio.NewWriter(file)
_, err := writer.WriteString("Первая строка\n")
if err != nil {
    fmt.Println(err)
}
writer.Flush() // обязательно сбрасываем буфер на диск
```

* Буферизация повышает **скорость записи больших объёмов данных**.

---

### Удаление и переименование файлов

* Удаление файла:

```go
err := os.Remove("output.txt")
```

* Переименование файла:

```go
err := os.Rename("old.txt", "new.txt")
```

* Обе операции возвращают ошибку, если что-то пошло не так.

---

### Итого

* Go предоставляет **простые и мощные функции для работы с файлами** через `os`, `io` и `bufio`.
* Для **малых файлов** удобно использовать `os.ReadFile` и `os.WriteFile`.
* Для **больших файлов** лучше использовать **Scanner и Writer** с буферизацией.
* Всегда закрывайте файлы через `defer file.Close()`, чтобы **освободить ресурсы и избежать утечек**.