# Основы Go. Работа с CSV и YAML

Помимо JSON и XML, в реальных проектах часто приходится работать с **CSV** (табличные данные) и **YAML** (конфигурации). Go предоставляет **пакет `encoding/csv`** для CSV и сторонние библиотеки, например **`gopkg.in/yaml.v3`**, для YAML.

---

### CSV

* **CSV (Comma-Separated Values)** — это текстовый формат, где данные разделены **запятыми или другими разделителями**.
* Идеален для экспорта/импорта таблиц, отчётов, Excel-файлов.

#### Чтение CSV

```go
package main

import (
    "encoding/csv"
    "fmt"
    "os"
)

func main() {
    file, err := os.Open("data.csv")
    if err != nil {
        fmt.Println(err)
        return
    }
    defer file.Close()

    reader := csv.NewReader(file)
    records, err := reader.ReadAll() // читаем весь CSV сразу
    if err != nil {
        fmt.Println(err)
        return
    }

    for _, row := range records {
        fmt.Println(row)
    }
}
```

* `ReadAll` возвращает все строки как **срез срезов строк** (`[][]string`).
* Для больших файлов можно использовать `Read()` в цикле для **построчного чтения**.

#### Запись CSV

```go
file, _ := os.Create("output.csv")
defer file.Close()

writer := csv.NewWriter(file)
defer writer.Flush()

data := [][]string{
    {"Name", "Email", "Age"},
    {"Олег", "oleg@example.com", "25"},
    {"Анна", "anna@example.com", "30"},
}

for _, row := range data {
    if err := writer.Write(row); err != nil {
        fmt.Println(err)
    }
}
```

* `Flush()` отправляет данные на диск после буферизации.

---

### YAML

* **YAML (YAML Ain’t Markup Language)** — удобен для конфигураций: **читаемый человекоориентированный формат**, поддерживает вложенность и структуры.
* Для работы с YAML в Go используют библиотеку `gopkg.in/yaml.v3`.

#### Чтение YAML

```go
package main

import (
    "fmt"
    "gopkg.in/yaml.v3"
    "os"
)

type Config struct {
    Port int    `yaml:"port"`
    Host string `yaml:"host"`
}

func main() {
    file, _ := os.ReadFile("config.yaml")
    var cfg Config
    err := yaml.Unmarshal(file, &cfg)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Println(cfg.Host, cfg.Port)
}
```

#### Запись YAML

```go
cfg := Config{Host: "localhost", Port: 8080}
data, err := yaml.Marshal(&cfg)
if err != nil {
    fmt.Println(err)
    return
}

err = os.WriteFile("output.yaml", data, 0644)
if err != nil {
    fmt.Println(err)
}
```

* Использование тегов `yaml:"имя_поля"` позволяет управлять **именами ключей в YAML**.

---

### Итого

* **CSV** подходит для табличных данных, прост в чтении и записи.
* **YAML** удобен для конфигураций и структурированных данных.
* В Go есть **стандартные и сторонние пакеты**, которые делают работу с этими форматами **удобной и безопасной**.
* Используйте буферизацию и теги для эффективной и корректной работы с данными.