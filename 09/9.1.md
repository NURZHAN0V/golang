# HTTP-клиент

В Go часто нужно **обращаться к веб-сервисам**, получать данные с API или загружать страницы. Для этого используется пакет **`net/http`**, который предоставляет удобный и простой в использовании HTTP-клиент.

---

### Простейший запрос

```go
package main

import (
    "fmt"
    "io/ioutil"
    "net/http"
)

func main() {
    resp, err := http.Get("https://jsonplaceholder.typicode.com/posts/1")
    if err != nil {
        fmt.Println("Ошибка запроса:", err)
        return
    }
    defer resp.Body.Close()

    body, err := ioutil.ReadAll(resp.Body)
    if err != nil {
        fmt.Println("Ошибка чтения ответа:", err)
        return
    }

    fmt.Println(string(body))
}
```

* `http.Get` выполняет **GET-запрос** к указанному URL.
* `defer resp.Body.Close()` гарантирует закрытие соединения.
* `ioutil.ReadAll` считывает весь ответ в память. Для больших ответов лучше использовать **буферизированное чтение**.

---

### Использование `http.Client`

* Для более сложных запросов создают объект `http.Client`:

```go
client := &http.Client{}
req, _ := http.NewRequest("GET", "https://jsonplaceholder.typicode.com/posts/1", nil)
req.Header.Set("User-Agent", "Go-HTTP-Client/1.0")

resp, err := client.Do(req)
if err != nil {
    fmt.Println(err)
    return
}
defer resp.Body.Close()
```

* `http.Client` позволяет **настраивать таймауты, прокси, повторные попытки и другие параметры**.
* `NewRequest` используется для **установки заголовков, метода запроса и тела**.

---

### POST-запрос

```go
data := strings.NewReader(`{"title":"Hello Go","body":"Content","userId":1}`)
resp, err := http.Post("https://jsonplaceholder.typicode.com/posts", "application/json", data)
if err != nil {
    fmt.Println(err)
    return
}
defer resp.Body.Close()

body, _ := ioutil.ReadAll(resp.Body)
fmt.Println(string(body))
```

* `http.Post` принимает три аргумента: URL, Content-Type и тело запроса.
* Для **форм-данных** используйте `url.Values` и `strings.NewReader`.

---

### Таймауты и безопасное закрытие

```go
client := &http.Client{
    Timeout: 5 * time.Second,
}

resp, err := client.Get("https://jsonplaceholder.typicode.com/posts/1")
if err != nil {
    fmt.Println(err)
    return
}
defer resp.Body.Close()
```

* Таймаут **предотвращает зависание программы** при проблемах с сетью.
* Всегда используйте `defer resp.Body.Close()`, чтобы соединения корректно закрывались.

---

### Итого

* Go имеет **мощный встроенный HTTP-клиент**, подходящий как для простых, так и для сложных запросов.
* Для **простых GET/POST-запросов** достаточно функций `http.Get` и `http.Post`.
* Для **настраиваемых запросов** используйте `http.Client` и `http.NewRequest`.
* **Не забывайте о таймаутах и закрытии ответа** — это предотвращает утечки ресурсов.