# HTTP-сервер

Go отлично подходит для **создания веб-серверов** и API. Для этого используется пакет **`net/http`**, который позволяет быстро запускать сервер и обрабатывать HTTP-запросы.

---

### Простейший сервер

```go
package main

import (
    "fmt"
    "net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Привет, мир!")
}

func main() {
    http.HandleFunc("/", handler)
    fmt.Println("Сервер запущен на http://localhost:8080")
    http.ListenAndServe(":8080", nil)
}
```

* `http.HandleFunc` связывает URL с функцией-обработчиком.
* `w http.ResponseWriter` используется для **отправки ответа клиенту**.
* `r *http.Request` содержит **информацию о запросе**: метод, заголовки, параметры и тело.
* `ListenAndServe` запускает сервер на указанном порту.

---

### Обработчики с разными маршрутами

```go
func helloHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Привет, пользователь!")
}

func byeHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "До свидания!")
}

func main() {
    http.HandleFunc("/hello", helloHandler)
    http.HandleFunc("/bye", byeHandler)
    http.ListenAndServe(":8080", nil)
}
```

* Каждый маршрут может иметь **свою функцию-обработчик**.
* Сервер **динамически определяет, какой обработчик вызвать** в зависимости от пути URL.

---

### Работа с параметрами запроса

```go
func greetHandler(w http.ResponseWriter, r *http.Request) {
    name := r.URL.Query().Get("name")
    if name == "" {
        name = "гость"
    }
    fmt.Fprintf(w, "Привет, %s!", name)
}

func main() {
    http.HandleFunc("/greet", greetHandler)
    http.ListenAndServe(":8080", nil)
}
```

* `r.URL.Query().Get("name")` извлекает **параметр из строки запроса**.
* Если параметр не указан, можно задать значение по умолчанию.

---

### Отправка JSON-ответа

```go
type User struct {
    Name string `json:"name"`
    Age  int    `json:"age"`
}

func userHandler(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    u := User{Name: "Олег", Age: 25}
    json.NewEncoder(w).Encode(u)
}

func main() {
    http.HandleFunc("/user", userHandler)
    http.ListenAndServe(":8080", nil)
}
```

* Устанавливаем **заголовок Content-Type** для правильного распознавания формата.
* `json.NewEncoder(w).Encode(u)` напрямую **отправляет структуру как JSON** клиенту.

---

### Итого

* Go позволяет создавать **легковесные и быстрые HTTP-серверы**.
* Обработчики легко связывать с **конкретными маршрутами**.
* Параметры запроса и тело запроса доступны через объект `*http.Request`.
* JSON-ответы можно отправлять напрямую с помощью `json.Encoder`.
* Go HTTP-серверы часто используются для **REST API, микросервисов и внутренних инструментов**.