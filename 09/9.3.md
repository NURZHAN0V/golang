# REST API на Go

REST API — это способ **обмена данными между клиентом и сервером** через HTTP. Go идеально подходит для создания **легковесных и быстрых API**, используя стандартный пакет `net/http` или фреймворки, например **Gin** или **Echo**.

---

### Простейший REST API

```go
package main

import (
    "encoding/json"
    "fmt"
    "net/http"
)

type User struct {
    ID   int    `json:"id"`
    Name string `json:"name"`
}

var users = []User{
    {ID: 1, Name: "Олег"},
    {ID: 2, Name: "Анна"},
}

func getUsers(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    json.NewEncoder(w).Encode(users)
}

func main() {
    http.HandleFunc("/users", getUsers)
    fmt.Println("API запущено на http://localhost:8080")
    http.ListenAndServe(":8080", nil)
}
```

* **Маршрут `/users`** возвращает список пользователей.
* JSON-ответ создаётся через `json.NewEncoder(w).Encode()`.
* REST API строится вокруг **ресурсов** (пользователи, посты, продукты).

---

### Разные HTTP-методы

* **GET** — получить данные
* **POST** — создать новый ресурс
* **PUT / PATCH** — обновить ресурс
* **DELETE** — удалить ресурс

```go
func createUser(w http.ResponseWriter, r *http.Request) {
    if r.Method != http.MethodPost {
        w.WriteHeader(http.StatusMethodNotAllowed)
        return
    }

    var newUser User
    err := json.NewDecoder(r.Body).Decode(&newUser)
    if err != nil {
        w.WriteHeader(http.StatusBadRequest)
        return
    }

    newUser.ID = len(users) + 1
    users = append(users, newUser)

    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusCreated)
    json.NewEncoder(w).Encode(newUser)
}

func main() {
    http.HandleFunc("/users", func(w http.ResponseWriter, r *http.Request) {
        switch r.Method {
        case http.MethodGet:
            getUsers(w, r)
        case http.MethodPost:
            createUser(w, r)
        default:
            w.WriteHeader(http.StatusMethodNotAllowed)
        }
    })
    http.ListenAndServe(":8080", nil)
}
```

* В Go можно проверять **метод запроса** через `r.Method`.
* Для POST-запросов данные обычно передаются в **JSON в теле запроса**.
* При успешном создании нового ресурса сервер возвращает **HTTP 201 Created**.

---

### REST API с фреймворком Gin

Фреймворки упрощают обработку маршрутов, параметров и middleware:

```go
package main

import (
    "github.com/gin-gonic/gin"
)

type User struct {
    ID   int    `json:"id"`
    Name string `json:"name"`
}

var users = []User{
    {ID: 1, Name: "Олег"},
    {ID: 2, Name: "Анна"},
}

func main() {
    r := gin.Default()

    r.GET("/users", func(c *gin.Context) {
        c.JSON(200, users)
    })

    r.POST("/users", func(c *gin.Context) {
        var newUser User
        if err := c.ShouldBindJSON(&newUser); err != nil {
            c.JSON(400, gin.H{"error": err.Error()})
            return
        }
        newUser.ID = len(users) + 1
        users = append(users, newUser)
        c.JSON(201, newUser)
    })

    r.Run(":8080") // запуск сервера
}
```

* Gin автоматически **парсит JSON**, управляет заголовками и ошибками.
* Удобно использовать **маршруты и группы маршрутов**, middleware, логирование и аутентификацию.

---

### Итого

* REST API в Go строится вокруг ресурсов и HTTP-методов.
* Для простых API достаточно стандартного пакета `net/http`.
* Для более сложных проектов удобно использовать фреймворки вроде **Gin**.
* Go позволяет создавать **быстрые, надёжные и читаемые API**, легко масштабируемые на микросервисы.