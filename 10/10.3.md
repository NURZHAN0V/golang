# Логирование (log, slog, logrus, zap)

Логирование — это **важная часть любой программы**, которая помогает отслеживать её работу, находить ошибки и анализировать поведение в продакшене. В Go есть несколько подходов и библиотек для логирования: от встроенного пакета `log` до продвинутых `logrus` и `zap`.

---

### Встроенный пакет `log`

```go
package main

import (
    "log"
)

func main() {
    log.Println("Просто информационное сообщение")
    log.Printf("Форматированное сообщение: %d", 42)
    log.Fatal("Сообщение с завершением программы") // вывод и os.Exit(1)
    // log.Panic("Сообщение с паникой") // вывод и panic()
}
```

* `log.Println` — вывод простого сообщения.
* `log.Printf` — форматированный вывод.
* `log.Fatal` — вывод и завершение программы с кодом ошибки 1.
* `log.Panic` — вывод и вызов `panic()`.

Плюсы: простота и встроенность.
Минусы: ограниченные возможности форматирования и структурированного логирования.

---

### Новый пакет `slog` (Go 1.21+)

`slog` — это **современный встроенный логгер**, который поддерживает структурированные логи и уровни логирования:

```go
package main

import (
    "log/slog"
)

func main() {
    logger := slog.New(slog.NewTextHandler(os.Stdout))
    
    logger.Info("Пример информационного лога", "user", "Олег", "age", 30)
    logger.Error("Ошибка при обработке запроса", "code", 500)
}
```

* Поддерживает **структурированные ключ-значение**.
* Логи читаемы человеком и легко парсятся автоматическими системами.

---

### Logrus

`logrus` — популярная сторонняя библиотека для **структурированного логирования**:

```go
import (
    log "github.com/sirupsen/logrus"
)

func main() {
    log.SetFormatter(&log.JSONFormatter{}) // вывод в JSON
    log.WithFields(log.Fields{
        "user": "Олег",
        "age":  30,
    }).Info("Пользователь вошёл в систему")
    
    log.Warn("Предупреждение")
    log.Error("Ошибка")
}
```

* Поддерживает **уровни логов** (`Info`, `Warn`, `Error`).
* Можно выводить в **JSON** или обычный текст.
* Хорошо интегрируется с внешними системами мониторинга.

---

### Zap

`zap` — **очень быстрый и структурированный логгер** от Uber, подходящий для высоконагруженных приложений:

```go
import (
    "go.uber.org/zap"
)

func main() {
    logger, _ := zap.NewProduction() // или zap.NewDevelopment()
    defer logger.Sync()
    
    logger.Info("Пользователь вошёл в систему",
        zap.String("user", "Олег"),
        zap.Int("age", 30),
    )
    
    logger.Error("Ошибка при обработке запроса", zap.Int("code", 500))
}
```

* Очень быстрый и оптимизированный.
* Поддерживает **структурированные логи с уровнями**.
* Часто используется в **продакшн-системах с высокой нагрузкой**.

---

### Итого

* Для простых задач подходит **встроенный `log`**.
* Для структурированных логов и продакшена стоит использовать **`slog`, `logrus` или `zap`**.
* Важно определиться с **уровнями логов** (Info, Warn, Error) и единым форматом для мониторинга.
* Структурированные логи удобны для анализа, фильтрации и интеграции с системами вроде Grafana, ELK или Loki.