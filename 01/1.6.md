# 1.6 –û—à–∏–±–∫–∏ 2.0 ‚Äî `errors.Is`, `errors.Join`, –æ–±—ë—Ä—Ç–∫–∏

> –í Go –æ—à–∏–±–∫–∞ ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –í—ã –ª–∏–±–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –µ—ë, –ª–∏–±–æ –ø–µ—Ä–µ–¥–∞—ë—Ç–µ –¥–∞–ª—å—à–µ. –° –≤–µ—Ä—Å–∏–∏ 1.20 –ø–æ—è–≤–∏–ª–æ—Å—å –µ—â—ë –±–æ–ª—å—à–µ —É–¥–æ–±—Å—Ç–≤.

## 1. –ë–∞–∑–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω ¬´–æ—à–∏–±–∫–∞ ‚Äì –≤—Ç–æ—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ¬ª
```go
f, err := os.Open("data.txt")
if err != nil {
    return err // –ø–µ—Ä–µ–¥–∞—ë–º –≤–≤–µ—Ä—Ö
}
// –∏—Å–ø–æ–ª—å–∑—É–µ–º f‚Ä¶
```

## 2. –°–æ–∑–¥–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
```go
var ErrNotFound = errors.New("not found")

func find(id int) (User, error) {
    if id == 0 {
        return User{}, ErrNotFound
    }
    return User{ID: id}, nil
}
```

## 3. –û–±—ë—Ä—Ç–∫–∞ –æ—à–∏–±–æ–∫ `fmt.Errorf` + `%w`
```go
if err := findFile(); err != nil {
    return fmt.Errorf("init config: %w", err)
}
```
`%w` –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é –æ—à–∏–±–∫—É, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤.

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é `errors.Is` –∏ `errors.As`
```go
if errors.Is(err, os.ErrNotExist) {
    // —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
}

var pathErr *os.PathError
if errors.As(err, &pathErr) {
    fmt.Println("–æ—à–∏–±–∫–∞ –ø—É—Ç–∏:", pathErr.Path)
}
```

## 5. `errors.Join` ‚Äì –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```go
func closeAll(cs ...io.Closer) error {
    var errs []error
    for _, c := range cs {
        if err := c.Close(); err != nil {
            errs = append(errs, err)
        }
    }
    return errors.Join(errs...)
}
```
`Join` –≤–µ—Ä–Ω—ë—Ç *–æ–¥–∏–Ω* –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.

## 6. `errors.Unwrap` –∏ —Ü–µ–ø–æ—á–∫–∞
```go
root := errors.New("root")
wrap := fmt.Errorf("level1: %w", root)
fmt.Println(errors.Unwrap(wrap) == root) // true
```

## 7. –°–æ–≤–µ—Ç –ø–æ —Å—Ç–∏–ª—é
1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—à–∏–±–∫—É —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è.  
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Is/As`, –∞ –Ω–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–µ.  
3. –ó–∞–≤–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ –æ—à–∏–±–∫—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –Ω–∞ ¬´–≥—Ä–∞–Ω–∏—Ü–µ —Å–ª–æ—è¬ª (handler ‚Üí service, service ‚Üí repo).  
4. –ù–µ –±–æ–π—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ `ErrXYZ` ‚Äî —ç—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç.

## –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è üìù
1. –ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `readJSON(path string) error`, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é –æ—à–∏–±–∫—É `ErrEmpty` (—Å –ø–æ–º–æ—â—å—é `errors.New`), –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –ø—É—Å—Ç. –í `main` –æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ç—Ä–∏ —Å–ª—É—á–∞—è: –Ω–µ—Ç —Ñ–∞–π–ª–∞, –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª, —É—Å–ø–µ—à–Ω–æ–µ —á—Ç–µ–Ω–∏–µ.
2. –°—ã–º–∏—Ç–∏—Ä—É–π—Ç–µ —Ç—Ä–∏ –æ—à–∏–±–∫–∏ (`errors.New`) –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ `errors.Join`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–ª–∏–Ω—É `errors.Unwrap` –≤ —Ü–∏–∫–ª–µ.
